--CRIAÃ‡AS E ACOMPANHAMENTO
SELECT DISTINCT ATEND.COD_AREA,TABEQ.MICROAREA,PESSOA.NOME,TPMONIT.DESCRICAO,ATEND.DATA,
EXTRACT(YEAR FROM AGE(PESSOA.DATA_NASCIMENTO)) AS IDADE,TABPROF.NOME_PROF
FROM SIABFACIL.ATENDIMENTO AS ATEND
LEFT JOIN SIABFACIL.MONITORAMENTO AS MONIT ON ATEND.ID = MONIT.ATENDIMENTO_ID
LEFT JOIN SIABFACIL.TIPO_DE_MONITORAMENTO AS TPMONIT ON MONIT.TIPO_DE_MONITORAMENTO_ID = TPMONIT.ID
LEFT JOIN SIABFACIL.MONITORADOR AS PROF ON PROF.ID = ATEND.MONITORADOR_ID
LEFT JOIN SIABFACIL.FAMILIA AS FAMILIA ON ATEND.FAMILIA_ID = FAMILIA.ID
LEFT JOIN SIABFACIL.PESSOA AS PESSOA ON ATEND.PESSOA_ID = PESSOA.ID
LEFT JOIN CNES.LFCES018 AS TABPROF ON ATEND.PROF_ID = TABPROF.PROF_ID
LEFT JOIN CNES.LFCES038 AS TABEQ ON TABPROF.PROF_ID = TABEQ.PROF_ID
WHERE TPMONIT.ID IN (58,59,60,61,62,63,64,65,66,67,68,69)
AND DATE_PART('YEAR',AGE(PESSOA.DATA_NASCIMENTO)) <= 2
AND ATEND.DATA >= '2017-07-01'
AND ATEND.DATA <= '2017-07-30'
AND ATEND.MONITORADOR_ID IN (3)
AND ATEND.COD_AREA in ('5151', '5152', '5153', '5154')
ORDER BY MICROAREA,DATA;